# Promptfoo E2E Chatbot Evaluation Configuration
# This config tests the full chatbot pipeline with real API calls

defaultTest:
  options:
    provider: openai:gpt-4.1-mini
  assert:
    - type: llm-rubric
      value: should either cite the source directly or indicate that the information is not available WITHOUT mentioning its a "retrieved context" explicitly.

# Single test case with mixed fast and slow assertions
tests:
  - description: 'EU policy question triggers RAG retrieval and provides factual response'
    vars:
      query: "What is the EPP's stance on migration?"
    assert:
      # Fast assertions - deterministic checks
      - type: javascript
        value: output.length > 100

      - type: javascript
        value: metadata.category === 'eu2024_policy'

      - type: javascript
        value: metadata.usedRAG === true

      - type: latency
        threshold: 10000